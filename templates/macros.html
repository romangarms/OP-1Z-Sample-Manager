{# Macro for a navigation button with optional icon #}
{% macro nav_button(url, text, style='primary', icon=none) %}
<button onclick="window.location.href='{{ url }}'" class="nav-btn nav-btn-{{ style }}">
    {% if icon %}<i data-lucide="{{ icon }}"></i>{% endif %}
    {{ text }}
</button>
{% endmacro %}

{# Macro for a single sample category box #}
{% macro sample_category_box(id, title) %}
<div class="sample-category">
    <div class="samplepackbox" id="{{ id }}">
        <h3>{{ title }}</h3>
    </div>
</div>
{% endmacro %}

{# Macro for a row containing two sample category boxes #}
{% macro sample_category_pair(id1, title1, id2, title2) %}
<div class="sample-row">
    {{ sample_category_box(id1, title1) }}
    {{ sample_category_box(id2, title2) }}
</div>
{% endmacro %}

{# Macro for error container #}
{% macro error_container(id='validation-error', message_id=none) %}
{% set msg_id = message_id or (id ~ '-message') %}
<div id="{{ id }}-container" class="error-container" hidden>
    <p id="{{ msg_id }}"></p>
</div>
{% endmacro %}

{# Macro for device tabs (OP-Z / OP-1 switcher) #}
{% macro device_tabs(active='opz') %}
<div class="device-tabs">
    <button class="device-tab {{ 'active' if active == 'opz' else '' }}" data-device="opz">OP-Z</button>
    <button class="device-tab {{ 'active' if active == 'op1' else '' }}" data-device="op1">OP-1</button>
</div>
{% endmacro %}

{# Macro for simple loading overlay with spinner #}
{% macro loading_overlay(id='loading', message='Loading...') %}
<div id="{{ id }}-overlay" class="loading-overlay" hidden>
    <div class="loading-spinner"></div>
    <span>{{ message }}</span>
</div>
{% endmacro %}

{# Macro for loading overlay with icon and progress bar #}
{% macro loading_overlay_progress(id='loading', title='Processing...', message='Please wait...') %}
<div id="{{ id }}-overlay" class="loading-overlay hidden">
    <div class="loading-content samplepackbox">
        <i data-lucide="loader-2" class="spin loading-icon"></i>
        <h3 id="{{ id }}-title">{{ title }}</h3>
        <p id="{{ id }}-status">{{ message }}</p>
        <div class="progress-container">
            <div class="progress-bar" id="{{ id }}-progress"></div>
        </div>
    </div>
</div>
{% endmacro %}

{# Macro for settings modal - use caller() to inject page-specific settings #}
{% macro settings_modal(title='Conversion Settings') %}
<div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="settingsModalTitle">{{ title }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <h6>Pitch Correction</h6>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="setting-auto-pitch" checked>
                        <label class="form-check-label" for="setting-auto-pitch">
                            Auto-tune synth samples to nearest A note
                        </label>
                    </div>
                    <small class="text-muted">When enabled, synth samples will automatically be pitch-corrected to the nearest A note for proper tuning on OP-1/OP-Z devices.</small>
                </div>
                {{ caller() }}
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
{% endmacro %}
