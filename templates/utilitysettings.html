{% extends "base.html" %}
{% from 'macros.html' import nav_button %}

{% block stylesheets %}
<link rel="stylesheet" href="/static/css/utilitysettings.css">
{% endblock %}

{% block title %}
<title>OP-1Z Sample Manager and Converter Utility Settings</title>
{% endblock %}

{% block main %}
<h1>OP-1Z Sample Manager and Converter Utility Settings</h1>
<p class="page-description">Configure application settings and device paths.</p>

<div class="header-row">
    {{ nav_button('/', 'Home', icon='home') }}
    <button onclick="resetConfig()" class="nav-btn nav-btn-danger">
        <i data-lucide="rotate-ccw"></i>
        Reset Config
    </button>
</div>

<hr>

<!-- Device Detection Mode -->
<div class="settings-section">
    <div class="developer-mode-toggle">
        <label class="toggle-switch">
            <input type="checkbox" id="developer-mode-toggle" onchange="toggleDeveloperMode()">
            <span class="toggle-slider"></span>
        </label>
        <span class="toggle-label">Developer Mode</span>
    </div>
    <p class="toggle-description">Enable to access advanced settings for debugging and testing.</p>
</div>

<!-- Manual Device Paths (hidden by default, shown in developer mode) -->
<div id="manual-paths-container" style="display: none;">
    <hr>

    <!-- OP-Z Path -->
    <div>Set the path to the mounted OP-Z</div>
    <input id="opz-path-holder" placeholder="OP-Z mount path goes here" style="min-width: 200px;"
           onblur="setConfigPath('OPZ_MOUNT_PATH', 'opz-path-holder', 'opz-info')" />
    <button onclick="openPathPicker('/get-user-folder-path', 'opz-path-holder', 'opz-info', 'OPZ_MOUNT_PATH', true)" class="btn btn-warning">
      Open Folder Browser
    </button>
    <p id="opz-info"></p>

    <hr>

    <!-- OP-1 Path -->
    <div>Set the path to the mounted OP-1</div>
    <input id="op1-path-holder" placeholder="OP-1 mount path goes here" style="min-width: 200px;"
           onblur="setConfigPath('OP1_MOUNT_PATH', 'op1-path-holder', 'op1-info')" />
    <button onclick="openPathPicker('/get-user-folder-path', 'op1-path-holder', 'op1-info', 'OP1_MOUNT_PATH', true)" class="btn btn-warning">
      Open Folder Browser
    </button>
    <p id="op1-info"></p>

    <hr>

    <!-- Logger Level Dropdown -->
    <div>Set logger verbosity level:</div>
    <select class="form-select" id="logger-level-select" onchange="setLoggerLevelFromDropdown()">
      <option value="DEBUG">DEBUG</option>
      <option value="INFO">INFO</option>
      <option value="WARNING">WARNING</option>
      <option value="ERROR">ERROR</option>
      <option value="CRITICAL">CRITICAL</option>
    </select>
    <p id="logger-info"></p>
</div>

<hr>

<!-- Working Directory -->
<div>Set the working directory for exported samples and project backups</div>
<input id="working-dir-holder" placeholder="Working directory goes here" style="min-width: 200px;"
       onblur="setConfigPath('WORKING_DIRECTORY', 'working-dir-holder', 'working-dir-info')" />
<button onclick="openPathPicker('/get-user-folder-path', 'working-dir-holder', 'working-dir-info', 'WORKING_DIRECTORY', true)" class="btn btn-warning">
  Open Folder Browser
</button>
<p id="working-dir-info"></p>

<script src="/static/js/utilitysettings.js"></script>
{% endblock %}
